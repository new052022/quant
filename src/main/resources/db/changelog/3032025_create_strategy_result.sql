--liquibase formatted sql

--changeset a.khaustov:create_strategy_result_table
CREATE TABLE strategy_result (
    id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    session_id BIGINT NOT NULL,
    min_entry_price DOUBLE PRECISION,
    symbol VARCHAR(255),
    side VARCHAR(255),
    stop_price DOUBLE PRECISION,
    order_id BIGINT,
    created_at TIMESTAMP,
    updated_at TIMESTAMP
);

--changeset a.khaustov:add_fk_strategy_result_session
ALTER TABLE strategy_result
    ADD CONSTRAINT fk_strategy_result_session
    FOREIGN KEY (session_id) REFERENCES strategy_session (id);

--changeset a.khaustov:add_fk_strategy_result_order
ALTER TABLE strategy_result
    ADD CONSTRAINT fk_strategy_result_order
    FOREIGN KEY (order_id) REFERENCES orders (id);